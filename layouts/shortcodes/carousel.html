{{ $images := .Get "images" }} {{ $height := .Get "height" | default "400px" }}
{{ $id := .Get "id" | default (printf "carousel-%d" now.Unix) }}

<div
  id="{{ $id }}"
  class="carousel-container"
  style="position: relative; max-width: 100%; height: {{ $height }}; overflow: hidden; border-radius: 8px; box-shadow: 0 4px 6px rgba(0,0,0,0.1);"
>
  <!-- Images -->
  {{ range $index, $image := split $images "," }}
  <div
    class="carousel-slide {{ if eq $index 0 }}active{{ end }}"
    style="display: {{ if eq $index 0 }}block{{ else }}none{{ end }}; position: absolute; width: 100%; height: 100%;"
  >
    <img src="{{ trim $image " " }}" alt="Slide {{ add $index 1 }}"
    style="width: 100%; height: 100%; object-fit: cover;">
  </div>
  {{ end }}

  <!-- Navigation arrows -->
  <button
    class="carousel-prev"
    onclick="changeSlide('{{ $id }}', -1)"
    style="
      position: absolute;
      left: 10px;
      top: 50%;
      transform: translateY(-50%);
      background: rgba(0, 0, 0, 0.5);
      color: white;
      border: none;
      padding: 10px 15px;
      border-radius: 50%;
      cursor: pointer;
      font-size: 18px;
      z-index: 10;
    "
  >
    ❮
  </button>
  <button
    class="carousel-next"
    onclick="changeSlide('{{ $id }}', 1)"
    style="
      position: absolute;
      right: 10px;
      top: 50%;
      transform: translateY(-50%);
      background: rgba(0, 0, 0, 0.5);
      color: white;
      border: none;
      padding: 10px 15px;
      border-radius: 50%;
      cursor: pointer;
      font-size: 18px;
      z-index: 10;
    "
  >
    ❯
  </button>

  <!-- Dots indicator -->
  <div
    class="carousel-dots"
    style="
      position: absolute;
      bottom: 15px;
      left: 50%;
      transform: translateX(-50%);
      z-index: 10;
    "
  >
    {{ range $index, $image := split $images "," }}
    <span
      class="dot {{ if eq $index 0 }}active{{ end }}"
      onclick="currentSlide('{{ $id }}', {{ add $index 1 }})"
      style="height: 15px; width: 15px; margin: 0 5px; background-color: {{ if eq $index 0 }}#717171{{ else }}#bbb{{ end }}; border-radius: 50%; display: inline-block; cursor: pointer; transition: background-color 0.3s ease;"
    ></span>
    {{ end }}
  </div>
</div>

<script>
  function changeSlide(carouselId, direction) {
    const carousel = document.getElementById(carouselId);
    const slides = carousel.querySelectorAll('.carousel-slide');
    const dots = carousel.querySelectorAll('.dot');
    let currentIndex = Array.from(slides).findIndex((slide) =>
      slide.classList.contains('active')
    );

    slides[currentIndex].style.display = 'none';
    slides[currentIndex].classList.remove('active');
    dots[currentIndex].classList.remove('active');
    dots[currentIndex].style.backgroundColor = '#bbb';

    currentIndex += direction;

    if (currentIndex >= slides.length) currentIndex = 0;
    if (currentIndex < 0) currentIndex = slides.length - 1;

    slides[currentIndex].style.display = 'block';
    slides[currentIndex].classList.add('active');
    dots[currentIndex].classList.add('active');
    dots[currentIndex].style.backgroundColor = '#717171';
  }

  function currentSlide(carouselId, slideIndex) {
    const carousel = document.getElementById(carouselId);
    const slides = carousel.querySelectorAll('.carousel-slide');
    const dots = carousel.querySelectorAll('.dot');

    slides.forEach((slide) => {
      slide.style.display = 'none';
      slide.classList.remove('active');
    });

    dots.forEach((dot) => {
      dot.classList.remove('active');
      dot.style.backgroundColor = '#bbb';
    });

    slides[slideIndex - 1].style.display = 'block';
    slides[slideIndex - 1].classList.add('active');
    dots[slideIndex - 1].classList.add('active');
    dots[slideIndex - 1].style.backgroundColor = '#717171';
  }
</script>
